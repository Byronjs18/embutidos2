<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Login Administrador</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <h1>Login Administrador</h1>
    <form id="loginForm">
        <input type="email" name="correo" placeholder="Correo" required>
        <input type="password" name="contrasena" placeholder="Contraseña" required>
        <button type="submit">Ingresar</button>
    </form>

    <p id="mensaje" style="color:red;"></p>

    <script>
        const form = document.getElementById('loginForm');
        const mensaje = document.getElementById('mensaje');
        const boton = form.querySelector('button');

        form.addEventListener('submit', async e => {
            e.preventDefault();
            mensaje.textContent = '';
            boton.disabled = true;

            const correo = form.correo.value;
            const contrasena = form.contrasena.value;

            try {
                const res = await fetch('/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ correo, contrasena }),
                    credentials: 'same-origin'
                });


                const data = await res.json();

                if (res.ok) {
                    // Redirigir al panel después de login exitoso
                    window.location.href = '/panel';
                } else {
                    mensaje.textContent = data.mensaje || 'Error al iniciar sesión';
                }
            } catch (err) {
                mensaje.textContent = 'Error de conexión al servidor';
                console.error(err);
            } finally {
                boton.disabled = false;
            }
        });
    </script>
</body>

</html>